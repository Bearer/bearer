languages:
  - rust
patterns:
  - pattern: |
      let $<NAME> = $<VALUE>
    filters:
      - variable: NAME
        regex: (?i)(password|passwd|secret|api_key|apikey|token)
      - variable: VALUE
        regex: \A"[^"]+"\z
  - pattern: |
      const $<NAME>: $<_> = $<VALUE>
    filters:
      - variable: NAME
        regex: (?i)(password|passwd|secret|api_key|apikey|token)
      - variable: VALUE
        regex: \A"[^"]+"\z
severity: critical
metadata:
  description: "Hardcoded secret detected."
  remediation_message: "Use environment variables instead."
  cwe_id:
    - 798
  id: rust_hardcoded_secret_test

