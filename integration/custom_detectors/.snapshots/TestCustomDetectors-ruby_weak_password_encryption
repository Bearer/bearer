data_types:
    - name: Email Address
      detectors:
        - name: ruby
          locations:
            - filename: testdata/ruby/weak_password_encryption.rb
              line_number: 14
    - name: Firstname
      detectors:
        - name: ruby
          locations:
            - filename: testdata/ruby/weak_password_encryption.rb
              line_number: 15
    - name: Gender identity
      detectors:
        - name: ruby
          locations:
            - filename: testdata/ruby/weak_password_encryption.rb
              line_number: 17
    - name: Passwords
      detectors:
        - name: ruby
          locations:
            - filename: testdata/ruby/weak_password_encryption.rb
              line_number: 1
            - filename: testdata/ruby/weak_password_encryption.rb
              line_number: 2
            - filename: testdata/ruby/weak_password_encryption.rb
              line_number: 4
            - filename: testdata/ruby/weak_password_encryption.rb
              line_number: 5
            - filename: testdata/ruby/weak_password_encryption.rb
              line_number: 7
            - filename: testdata/ruby/weak_password_encryption.rb
              line_number: 10
            - filename: testdata/ruby/weak_password_encryption.rb
              line_number: 11
            - filename: testdata/ruby/weak_password_encryption.rb
              line_number: 21
    - name: Physical Address
      detectors:
        - name: ruby
          locations:
            - filename: testdata/ruby/weak_password_encryption.rb
              line_number: 16
risks:
    - detector_id: detect_ruby_weak_encryption
      data_types:
        - name: Email Address
          stored: false
          locations:
            - filename: testdata/ruby/weak_password_encryption.rb
              line_number: 14
              parent:
                line_number: 14
                content: Digest::SHA1.hexidigest(user.email)
        - name: Firstname
          stored: false
          locations:
            - filename: testdata/ruby/weak_password_encryption.rb
              line_number: 15
              parent:
                line_number: 15
                content: Digest::MD5.hexdigest(user.first_name)
        - name: Gender identity
          stored: false
          locations:
            - filename: testdata/ruby/weak_password_encryption.rb
              line_number: 17
              parent:
                line_number: 17
                content: Crypt::Blowfish.new("insecure").encrypt_block({ |u| user.gender_identity })
        - name: Passwords
          stored: false
          locations:
            - filename: testdata/ruby/weak_password_encryption.rb
              line_number: 1
              parent:
                line_number: 1
                content: Digest::SHA1.hexidigest(user.password)
            - filename: testdata/ruby/weak_password_encryption.rb
              line_number: 2
              parent:
                line_number: 2
                content: Digest::MD5.hexdigest(user.password)
            - filename: testdata/ruby/weak_password_encryption.rb
              line_number: 4
              parent:
                line_number: 4
                content: RC4.new("insecure").encrypt(user.password)
            - filename: testdata/ruby/weak_password_encryption.rb
              line_number: 5
              parent:
                line_number: 5
                content: Crypt::Blowfish.new("insecure").encrypt_block({ |u| user.password })
            - filename: testdata/ruby/weak_password_encryption.rb
              line_number: 7
              parent:
                line_number: 7
                content: OpenSSL::PKey::RSA.new(File.read('rsa.pem')).private_encrypt(customer.password)
        - name: Physical Address
          stored: false
          locations:
            - filename: testdata/ruby/weak_password_encryption.rb
              line_number: 16
              parent:
                line_number: 16
                content: RC4.new("insecure").encrypt(user.address)
components: []


--

