data_types:
    - name: Email Address
      detectors:
        - name: ruby
          locations:
            - filename: integration/custom_detectors/testdata/ruby/ftp.rb
              line_number: 7
              field_name: email
              object_name: user
    - name: Ethnic Origin
      detectors:
        - name: ruby
          locations:
            - filename: integration/custom_detectors/testdata/ruby/ftp.rb
              line_number: 27
              field_name: ethnicity
              object_name: user
risks:
    - detector_id: ruby_rails_insecure_ftp
      locations:
        - filename: integration/custom_detectors/testdata/ruby/ftp.rb
          line_number: 2
          parent:
            line_number: 2
            content: |-
                Net::FTP.open("ftp.site.com") do |ftp|
                  ftp.puttextfile("no_data.txt", "/no_data.txt")
                end
          content: |
            Net::FTP.open()
        - filename: integration/custom_detectors/testdata/ruby/ftp.rb
          line_number: 10
          parent:
            line_number: 10
            content: |-
                Net::FTP.open("ftp.site.com") do |ftp|
                  file = Tempfile.new("user_data")
                  begin
                    file << user.to_json
                    file.close

                    ftp.puttextfile(file.path, "/users/123.json")
                  ensure
                    file.close!
                  end
                end
          content: |
            Net::FTP.open()
        - filename: integration/custom_detectors/testdata/ruby/ftp.rb
          line_number: 24
          parent:
            line_number: 24
            content: |-
                Net::FTP.open("ftp.site.com") do |ftp|
                  file = Tempfile.new("user_data")
                  begin
                    file << { user: { ethnicity: "martian" } }.to_json
                    file.close

                    ftp.puttextfile(file.path, "/users/123.json")
                  ensure
                    file.close!
                  end
                end
          content: |
            Net::FTP.open()
    - detector_id: ruby_rails_insecure_ftp_data
      locations:
        - filename: integration/custom_detectors/testdata/ruby/ftp.rb
          line_number: 2
          parent:
            line_number: 2
            content: |-
                Net::FTP.open("ftp.site.com") do |ftp|
                  ftp.puttextfile("no_data.txt", "/no_data.txt")
                end
          content: |
            Net::FTP.open do
              $ANYTHING
            end
        - filename: integration/custom_detectors/testdata/ruby/ftp.rb
          line_number: 2
          parent:
            line_number: 2
            content: |-
                Net::FTP.open("ftp.site.com") do |ftp|
                  ftp.puttextfile("no_data.txt", "/no_data.txt")
                end
          content: |
            Net::FTP.open do
              $ANYTHING
            end
        - filename: integration/custom_detectors/testdata/ruby/ftp.rb
          line_number: 10
          parent:
            line_number: 10
            content: |-
                Net::FTP.open("ftp.site.com") do |ftp|
                  file = Tempfile.new("user_data")
                  begin
                    file << user.to_json
                    file.close

                    ftp.puttextfile(file.path, "/users/123.json")
                  ensure
                    file.close!
                  end
                end
          content: |
            Net::FTP.open do
              $ANYTHING
            end
        - filename: integration/custom_detectors/testdata/ruby/ftp.rb
          line_number: 10
          parent:
            line_number: 10
            content: |-
                Net::FTP.open("ftp.site.com") do |ftp|
                  file = Tempfile.new("user_data")
                  begin
                    file << user.to_json
                    file.close

                    ftp.puttextfile(file.path, "/users/123.json")
                  ensure
                    file.close!
                  end
                end
          content: |
            Net::FTP.open do
              $ANYTHING
            end
        - filename: integration/custom_detectors/testdata/ruby/ftp.rb
          line_number: 10
          parent:
            line_number: 10
            content: |-
                Net::FTP.open("ftp.site.com") do |ftp|
                  file = Tempfile.new("user_data")
                  begin
                    file << user.to_json
                    file.close

                    ftp.puttextfile(file.path, "/users/123.json")
                  ensure
                    file.close!
                  end
                end
          content: |
            Net::FTP.open do
              $ANYTHING
            end
        - filename: integration/custom_detectors/testdata/ruby/ftp.rb
          line_number: 24
          parent:
            line_number: 24
            content: |-
                Net::FTP.open("ftp.site.com") do |ftp|
                  file = Tempfile.new("user_data")
                  begin
                    file << { user: { ethnicity: "martian" } }.to_json
                    file.close

                    ftp.puttextfile(file.path, "/users/123.json")
                  ensure
                    file.close!
                  end
                end
          content: |
            Net::FTP.open do
              $ANYTHING
            end
        - filename: integration/custom_detectors/testdata/ruby/ftp.rb
          line_number: 24
          parent:
            line_number: 24
            content: |-
                Net::FTP.open("ftp.site.com") do |ftp|
                  file = Tempfile.new("user_data")
                  begin
                    file << { user: { ethnicity: "martian" } }.to_json
                    file.close

                    ftp.puttextfile(file.path, "/users/123.json")
                  ensure
                    file.close!
                  end
                end
          content: |
            Net::FTP.open do
              $ANYTHING
            end
        - filename: integration/custom_detectors/testdata/ruby/ftp.rb
          line_number: 24
          parent:
            line_number: 24
            content: |-
                Net::FTP.open("ftp.site.com") do |ftp|
                  file = Tempfile.new("user_data")
                  begin
                    file << { user: { ethnicity: "martian" } }.to_json
                    file.close

                    ftp.puttextfile(file.path, "/users/123.json")
                  ensure
                    file.close!
                  end
                end
          content: |
            Net::FTP.open do
              $ANYTHING
            end
components: []


--

