critical:
    - policy_name: Insecure FTP with Data Category
      policy_description: Communicating Data Category with an insecure FTP server. Only connect to FTP securely.
      line_number: 27
      filename: testdata/ruby/insecure_ftp.rb
      category_groups:
        - PII
        - Sensitive personal data
      parent_line_number: 24
      parent_content: |-
        Net::FTP.open("ftp.site.com") do |ftp|
          file = Tempfile.new("user_data")
          begin
            file << { user: { ethnicity: "martian" } }.to_json
            file.close

            ftp.puttextfile(file.path, "/users/123.json")
          ensure
            file.close!
          end
        end
      omit_parent: false
medium:
    - policy_name: Insecure FTP
      policy_description: Communication with an insecure FTP server in an application processing sensitive data. Only connect to FTP securely.
      line_number: 10
      filename: testdata/ruby/insecure_ftp.rb
      category_groups:
        - PII
        - Sensitive personal data
      parent_line_number: 10
      parent_content: Net::FTP.new("ftp.ruby-lang.org")
      omit_parent: false
    - policy_name: Insecure FTP
      policy_description: Communication with an insecure FTP server in an application processing sensitive data. Only connect to FTP securely.
      line_number: 17
      filename: testdata/ruby/insecure_ftp.rb
      category_groups:
        - PII
        - Sensitive personal data
      parent_line_number: 17
      parent_content: |-
        Net::FTP.open('example.com') do |ftp|
          ftp.login
          files = ftp.chdir('pub/lang/ruby/contrib')
          files = ftp.list('n*')
          ftp.getbinaryfile('nif.rb-0.91.gz', 'nif.gz', 1024)
        end
      omit_parent: false
    - policy_name: Insecure FTP
      policy_description: Communication with an insecure FTP server in an application processing sensitive data. Only connect to FTP securely.
      line_number: 24
      filename: testdata/ruby/insecure_ftp.rb
      category_groups:
        - PII
        - Sensitive personal data
      parent_line_number: 24
      parent_content: |-
        Net::FTP.open("ftp.site.com") do |ftp|
          file = Tempfile.new("user_data")
          begin
            file << { user: { ethnicity: "martian" } }.to_json
            file.close

            ftp.puttextfile(file.path, "/users/123.json")
          ensure
            file.close!
          end
        end
      omit_parent: false


--
Processing Detectors
Finished processing Detectors
Processing Dataflow
Finished processing Dataflow
Processing Policies
Processing policy Application level encryption missing
Finished processing policy Application level encryption missing
Processing policy Cookie leaking
Finished processing policy Cookie leaking
Processing policy HTTP GET parameters
Finished processing policy HTTP GET parameters
Processing policy Insecure communication
Finished processing policy Insecure communication
Processing policy Insecure FTP
Finished processing policy Insecure FTP
Processing policy Insecure FTP with Data Category
Finished processing policy Insecure FTP with Data Category
Processing policy Insecure HTTP GET
Finished processing policy Insecure HTTP GET
Processing policy Insecure HTTP with Data Category
Finished processing policy Insecure HTTP with Data Category
Processing policy Insecure SMTP
Finished processing policy Insecure SMTP
Processing policy JWT leaking
Finished processing policy JWT leaking
Processing policy Logger leaking
Finished processing policy Logger leaking
Processing policy Third-party data category exposure
Finished processing policy Third-party data category exposure
Processing policy Session leaking
Finished processing policy Session leaking
Processing policy SSL certificate verification disabled
Finished processing policy SSL certificate verification disabled
Processing policy Weak password encryption
Finished processing policy Weak password encryption
Finished processing policies

