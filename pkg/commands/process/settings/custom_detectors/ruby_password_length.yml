type: "risk"
languages:
  - ruby
patterns:
  - pattern: |
      class $<_:constant> < ApplicationRecord
        validates :password, length: { minimum: $<LENGTH> }
      end
    filters:
      - variable: LENGTH
        less_than: 8
  - pattern: |
      class $<_> < ApplicationRecord
        devise password_length: $<MIN_LENGTH>..$<MAX_LENGTH>
      end
    filters:
      - either:
        - variable: MAX_LENGTH
          less_than: 35
        - variable: MIN_LENGTH
          less_than: 8
  - pattern: |
      Devise.setup do |config|
        config.password_length = $<MIN_LENGTH>..$<MAX_LENGTH>
      end
    filters:
      - variable: MIN_LENGTH
        less_than: 8
  - pattern: |
      Devise.setup do |config|
        config.password_length = $<LENGTH>
      end
    filters:
      - variable: LENGTH
        less_than: 8
