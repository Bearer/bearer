type: "risk"
languages:
  - ruby
patterns:
  - pattern: |
      CSV.generate { $<DATA_TYPE> }
    filters:
      - variable: DATA_TYPE
        detection: datatype
  - pattern: |
      CSV.generate do
        $<DATA_TYPE>
      end
    filters:
      - variable: DATA_TYPE
        detection: datatype
  - pattern: |
      $<LIBRARY>.open { $<DATA_TYPE> }
    filters:
      - variable: LIBRARY
        values:
          - CSV
          - File
          - IO
      - variable: DATA_TYPE
        detection: datatype
  - pattern: |
      $<LIBRARY>.open do
        $<DATA_TYPE>
      end
    filters:
      - variable: LIBRARY
        values:
          - CSV
          - File
          - IO
      - variable: DATA_TYPE
        detection: datatype
