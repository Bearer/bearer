type: "risk"
languages:
  - ruby
patterns:
  - pattern: |
      CSV.generate { $<DATA_TYPE> }
    filters:
      - variable: DATA_TYPE
        detection: datatype
  - pattern: |
      CSV.generate do
        $<DATA_TYPE>
      end
    filters:
      - variable: DATA_TYPE
        detection: datatype
  - pattern: |
      $<LIBRARY>.open { $<DATA_TYPE> }
    filters:
      - variable: LIBRARY
        values:
          - CSV
          - File
          - IO
      - variable: DATA_TYPE
        detection: datatype
  - pattern: |
      $<LIBRARY>.open do
        $<DATA_TYPE>
      end
    filters:
      - variable: LIBRARY
        values:
          - CSV
          - File
          - IO
      - variable: DATA_TYPE
        detection: datatype
trigger: "local"
severity:
  default: "low"
  PII: "critical"
  PHI: "medium"
  PD: "high"
metadata:
  failure_message: "failure message DSW-011"
  description: "description DSW-011"
  remediation_message: "remediation message DSW-011"
  dsw_id: "DSW-011"
